@using EntityLayer.Concrete
@model List<Transaction>
@{
	ViewData["Title"] = "Index";
	Layout = "~/Views/Shared/UserLayout.cshtml";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="wrapper">

	<div class="content-wrapper">
		<section class="content-header">
			<div class="container-fluid">
				<div class="row mb-2">
					<div class="col-sm-6">
						<h1 class="card-title">Gelir/Gider Tablosu</h1>
					</div>
				</div>
			</div>
		</section>
		<section class="content">
			<div class="container-fluid">
				<div class="row">
					<div class="col-12">
						<div class="card">
							<div class="card-body">
								<table id="example1" class="table table-bordered table-striped">
									<thead>
										<tr>
											<th>Defter</th>
											<th>Banka</th>
											<th>Miktar</th>
											<th>Gelir/Gider</th>
											<th>Kategori</th>
											<th>Açıklama</th>
											<th>Ay</th>
											<th>Yıl</th>
											<th>İşlem Sahibi</th>
											<th>İşlem Tarihi</th>
										</tr>
									</thead>
									<tbody>
										@foreach (var item in Model)
										{
											<tr>
												<td>@item.Ledger.Name</td>
												<td>@item.Bank.BankName</td>
												<td>@(item.Amount.ToString("C", new System.Globalization.CultureInfo("tr-TR")))</td>

												@if (@item.Type=="Income")
												{
													<td class="text-green"> <i class="fa fa-level-up" style="color:green"></i> Gelir </td>
												}
												else
												{
													<td class="text-red"> <i class="fa fa-level-down" style="color:red"></i> Gider </td>
												}												
												<td>@item.Category</td>
												<td>@item.Description</td>
												<td>@(new System.Globalization.CultureInfo("tr-TR").DateTimeFormat.GetMonthName(item.Month))</td>
												<td>@item.Year</td>
												<td>@item.User.FullName</td>
												<td>@item.CreatedAt.ToLongDateString()</td>
												@if (!User.IsInRole("Member"))
												{
													<td>
													<button type="button" class="btn btn-outline-danger btn-sm" data-toggle="modal" data-target="#Sil_@item.Id">
														Sil
													</button>
												</td>
												<td><a href="/Transaction/EditTransaction/@item.Id" class="btn btn-danger">Düzenle</a></td>
												}
												
											</tr>

											<div class="modal fade" id="Sil_@item.Id" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
												<div class="modal-dialog modal-dialog-centered" role="document">
													<div class="modal-content">
														<div class="modal-header">
															<h5 class="modal-title" id="exampleModalLongTitle">İşlemi Sil</h5>
															<button type="button" class="close" data-dismiss="modal" aria-label="Close">
																<span aria-hidden="true">&times;</span>
															</button>
														</div>
														<div class="modal-body">
															<h4>İşlemi silmek istiyor musunuz?</h4>
														</div>
														<div class="modal-footer">
															<button type="button" class="btn btn-info mx-4" data-dismiss="modal">Vazgeç</button>
															@Html.ActionLink("Sil", "DeleteTransaction", new { id = @item.Id }, new { @class = "btn btn-danger mx-4" })
														</div>
													</div>
												</div>
											</div>
										}
								</table>

							</div>
							@if (!User.IsInRole("Member"))
												{
							<a href="/Transaction/AddTransaction/" class="btn btn-success">İşlem Oluştur</a>
												}
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>
	
</div>
